!function(t){var e={};function i(s){if(e[s])return e[s].exports;var a=e[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);class s{constructor(t=0,e=0){this.x=t,this.y=e}static fromPolar(t,e,i=e){const s=e*Math.cos(t),a=i*Math.sin(t);return new this(Math.floor(s),Math.floor(a))}static add(t,e){return new this(t.x+e.x,t.y+e.y)}static sub(t,e){return new this(t.x-e.x,t.y-e.y)}static eq(t,e){return t.x===e.x&&t.y===e.y}add(t){return this.x+=t.x,this.y+=t.y,this}addX(t){return this.x+=t,this}addY(t){return this.y+=t,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subX(t){return this.x-=t,this}subY(t){return this.y-=t,this}mul(t){return this.x=this.x*t,this.y=this.y*t,this}div(t){if(0!==t)return this.x=this.x/t,this.y=this.y/t,this}get magnitude(){return Math.hypot(this.x,this.y)}normalize(){return this.div(this.magnitude),this}getDistance(t={x:0,y:0}){const e=t.x-this.x,i=t.y-this.y;return Math.hypot(e,i)}getAngle(t={x:0,y:0}){return Math.atan2(this.y-t.y,this.x-t.x)}getMiddle(t){const e=.5*(this.x+t.x),i=.5*(this.y+t.y);return new s(e,i)}eq(t){return this.x===t.x&&this.y===t.y}isOpposite(t){return!this.eq(t)&&(this.x===-t.x&&this.y===-t.y)}copy(){return new s(this.x,this.y)}set(t){return this.x=t.x,this.y=t.y,this}change(t,e){return this.x=t,this.y=e,this}}function a(t="canvas"){const e=window.devicePixelRatio,i=window.innerHeight,s=window.innerWidth,a=document.querySelector(t);a.width=s*e,a.height=i*e;const n=a.getContext("2d");return n.scale(e,e),n}function n(t,e,i=!0){return i?Math.floor(Math.random()*(e-t+1)+t):Math.random()*(e-t)+t}function r(t,e=null,i=null){const s=document.createElement(t);return e&&function(t,e){Object.keys(e).forEach(i=>{switch(i){case"classes":e[i].forEach(e=>t.classList.add(e));break;case"textContent":t.textContent=e[i];break;case"selected":t.selected=e[i];default:t.setAttribute(i,e[i])}})}(s,e),i&&function(t,e){e.forEach(e=>t.appendChild(e))}(s,i),s}function l(t,e,i=e){const a=2*Math.PI/t;return Array.from({length:t},(t,n)=>{const r=n*a;return s.fromPolar(r,e,i)})}class o{constructor({parent:t,max:e,min:i,step:s=1,value:a,prop:n,scope:r,updateFn:l,label:o}){this.prop=n,this.scope=r,this.updateFn=l,this.label=o,this.max=e,this.min=i,this.step=s,this.value=a,this.parent=t,this.node=null,this.input=null,this.output=null,this.render(),this.eventListener()}render(){this.input=r("input",{type:"range",id:this.prop,max:this.max,min:this.min,step:this.step,value:this.value}),this.output=r("output",{textContent:this.value}),this.node=r("div",{classes:["slider"]},[r("label",{for:this.prop,textContent:`${this.label} â€” `}),this.output,r("br"),this.input]),this.parent.appendChild(this.node)}disable(){this.input.disabled=!0,this.node.style.opacity=.3}enable(){this.input.disabled=!1,this.node.style.opacity=1}eventListener(){this.input.addEventListener("input",this.eventHandler.bind(this))}eventHandler(t){const e=this.input.valueAsNumber;this.output.textContent=e,this.scope[this.prop]=e,this.updateFn()}}class c{constructor({parent:t,prop:e,scope:i=null,updateFn:s,value:a,labelTrue:n="on",labelFalse:r="off",title:l=null}){this.prop=e,this.scope=i,this.updateFn=s,this.labelTrue=n,this.labelFalse=r,this.value=a,this.title=l,this.node=null,this.parent=t,this.render(),this.eventListener()}render(){this.node=r("button",{id:this.prop,classes:["toggle"]},null),this.title&&(this.node.title=this.title),this.value?this.node.innerHTML=this.labelTrue:(this.node.classList.add("deactivated"),this.node.innerHTML=this.labelFalse),this.parent.appendChild(this.node)}eventListener(){this.node.addEventListener("click",this.eventHandler.bind(this))}eventHandler(t){this.node.classList.toggle("deactivated"),this.value=!this.value,this.value?this.node.innerHTML=this.labelTrue:this.node.innerHTML=this.labelFalse,this.scope&&(this.scope[this.prop]=this.value),this.updateFn()}}class h{constructor({parent:t,fn:e,updateFn:i=null,label:s,title:a=null,id:n}){this.fn=e,this.updateFn=i,this.label=s,this.id=n,this.title=a,this.node=null,this.parent=t,this.render(),this.eventListener()}render(){this.node=r("button",{id:this.id},null),this.node.innerHTML=this.label,this.title&&(this.node.title=this.title),this.parent.appendChild(this.node)}eventListener(){this.node.addEventListener("click",this.eventHandler.bind(this))}eventHandler(t){this.fn(),this.updateFn&&this.updateFn()}}const d={saveImg:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="save" class="svg-inline--fa fa-save fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"></path></svg>',erase:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="eraser" class="svg-inline--fa fa-eraser fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M497.941 273.941c18.745-18.745 18.745-49.137 0-67.882l-160-160c-18.745-18.745-49.136-18.746-67.883 0l-256 256c-18.745 18.745-18.745 49.137 0 67.882l96 96A48.004 48.004 0 0 0 144 480h356c6.627 0 12-5.373 12-12v-40c0-6.627-5.373-12-12-12H355.883l142.058-142.059zm-302.627-62.627l137.373 137.373L265.373 416H150.628l-80-80 124.686-124.686z"></path></svg>',randomOptions:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="dice-five" class="svg-inline--fa fa-dice-five fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M384 32H64C28.65 32 0 60.65 0 96v320c0 35.35 28.65 64 64 64h320c35.35 0 64-28.65 64-64V96c0-35.35-28.65-64-64-64zM128 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm0-192c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm96 96c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm96 96c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm0-192c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"></path></svg>',play:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="play" class="svg-inline--fa fa-play fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"></path></svg>',pause:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="pause" class="svg-inline--fa fa-pause fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"></path></svg>',cross:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>',circle:'<svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="circle" class="svg-inline--fa fa-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200z"></path></svg>',circleSolid:'<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="circle" class="svg-inline--fa fa-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"></path></svg>'};function p(t){const e=document.querySelector("#ui"),i=document.createElement("div"),s=document.createElement("p");return s.textContent=t,i.appendChild(s),e.appendChild(i),i}function u(t,e=t.min,i=t.max){t.input.value=n(e,i,!1),t.eventHandler()}class m{constructor({ctx:t,radius:e,position:i,velocity:a=new s,damping:n=.9,fixed:r=!1,boundaries:l={n:0,s:t.canvas.clientHeight,w:0,e:t.canvas.clientWidth},G:o=4,minDistance:c=5,maxDistance:h=25}){this.ctx=t,this.boundaries=l,this.radius=e,this.fixed=r,this.position=i,this.velocity=a,this.acceleration=new s,this.damping=n,this.G=o,this.minDistance=c,this.maxDistance=h,this.dragging=!1,this.dragOffset=new s}applyForce(t){this.acceleration.add(t)}update(){this.fixed||(this.velocity.add(this.acceleration),this.velocity.mul(this.damping),this.position.add(this.velocity),this.checkEdges(),this.acceleration.mul(0))}draw(){!function(t,e,i){t.beginPath(),t.arc(i.x,i.y,e,0,2*Math.PI,!1),t.closePath()}(this.ctx,this.radius,this.position),this.ctx.fill()}checkEdges(){(this.position.x>this.boundaries.e||this.position.x<this.boundaries.w)&&(this.position.x=this.position.x>this.boundaries.e?this.boundaries.e:this.boundaries.w,this.velocity.x*=-1),(this.position.y>this.boundaries.s||this.position.y<this.boundaries.n)&&(this.position.y=this.position.y>this.boundaries.s?this.boundaries.s:this.boundaries.n,this.velocity.y*=-1)}atract(t){let e=s.sub(this.position,t.position),i=e.magnitude;i=function(t,e,i){return Math.min(Math.max(t,e),i)}(i,this.minDistance,this.maxDistance);const a=this.G/(i*i);return e.normalize().mul(a),e}handleClick(t,e,i=!1){const a=new s(t,e),n=a.getDistance(this.position);(n<10&&!i||n<30)&&(this.dragging=!0,this.dragOffset.set(this.position.copy().sub(a)))}handleDrag(t,e){this.dragging&&this.position.change(t+this.dragOffset.x,e+this.dragOffset.y)}stopDragging(){this.dragging=!1}}class f{constructor({particleNumber:t,particleOptions:e}){this.particleOptions=e,this.particleNumber=t,this.ctx=e.ctx,this.setup()}setup(){const t=this.particleOptions;this.particles=Array.from({length:this.particleNumber},(e,i)=>{let s=new m({ctx:t.ctx,radius:"object"==typeof t.radius?t.radius[i%t.radius.length]:t.radius,position:t.position[i%t.position.length]});return t.velocity&&(s.velocity=t.velocity[i%t.velocity.length]),t.damping&&(s.damping=t.damping[i%t.damping.length]),t.boundaries&&(s.boundaries=t.boundaries),t.fixed&&(s.fixed=t.fixed),t.G&&(s.G=t.G),t.minDistance&&("object"==typeof t.minDistance?s.minDistance=t.minDistance[i%t.minDistance.length]:s.minDistance=t.minDistance),t.maxDistance&&("object"==typeof t.maxDistance?s.maxDistance=t.maxDistance[i%t.maxDistance.length]:s.maxDistance=t.maxDistance),s})}addParticle(t){this.particles.push(new m(t))}lockParticles(...t){t.length>0&&t.forEach(t=>this.particles[t].fixed=!0)}update({forces:t=[],fn:e=null}={}){this.particles.forEach(i=>{t.length>0&&t.forEach(t=>i.applyForce(t)),e&&e(i),i.update()})}draw(){this.particles.forEach(t=>t.draw())}setDragging(t=null){this.ctx.canvas.addEventListener("touchstart",t=>{t.preventDefault();const e=t.touches[0];this.particles.forEach(t=>t.handleClick(e.pageX,e.pageY,!0))}),this.ctx.canvas.addEventListener("touchmove",e=>{e.preventDefault();const i=e.touches[0];this.particles.forEach(e=>{e.handleDrag(i.pageX,i.pageY),t&&e.dragging&&t()})}),this.ctx.canvas.addEventListener("touchend",t=>{t.preventDefault(),this.particles.forEach(t=>t.stopDragging())}),this.ctx.canvas.addEventListener("mousedown",t=>{1===t.buttons&&this.particles.forEach(e=>e.handleClick(t.clientX,t.clientY))}),this.ctx.canvas.addEventListener("mousemove",e=>{this.particles.forEach(i=>{i.handleDrag(e.clientX,e.clientY),t&&i.dragging&&t()})}),this.ctx.canvas.addEventListener("mouseup",t=>{this.particles.forEach(t=>t.stopDragging())})}}class g{constructor({h:t,s:e,l:i,a:s=1}){this.original={h:t,s:e,l:i,a:s},[this.h,this.s,this.l,this.a]=[t,e,i,s]}static getRandom(){return{h:n(0,300),s:n(0,100),l:n(0,100),a:Math.random()}}reset(){return[this.h,this.s,this.l,this.a]=this.original,this}toOpposite(){return this.h=(this.h+180)%300,this.s=(this.s+50)%100,this.l=(this.l+50)%100,this.a=(this.a+.5)%1,this}randomize({maxH:t=150,maxS:e=10,maxL:i=10,maxA:s=.2}={}){return this.h=(n(0,t)+this.h)%300,this.s=(n(0,e)+this.s)%100,this.l=(n(0,i)+this.l)%100,this.a=(n(0,s)+this.a)%1,this}addH(t){return this.h=(this.h+t)%300,this}addS(t){return this.s=(this.s+t)%100,this}addL(t){return this.l=(this.l+t)%100,this}addA(t){return this.a=(this.a+t)%1,this}get hsl(){return`hsl(${this.h}, ${this.s}%, ${this.l}%)`}get hsla(){return`hsla(${this.h}, ${this.s}%, ${this.l}%, ${this.a})`}hslToRgb(){let t,e,i;if(0==this.s)t=e=i=this.l;else{function s(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}const a=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,n=2*this.l-a;t=s(n,a,this.h+1/3),e=s(n,a,this.h),i=s(n,a,this.h-1/3)}return{r:255*t,g:255*e,b:255*i,a:this.a}}}!function(){const t=document.querySelector("#panel"),e=document.querySelector("#toggle-panel");new c({parent:e,prop:"toggle-panel-btn",value:!1,labelTrue:d.circleSolid,labelFalse:d.cross,title:"open/close menu",updateFn:function(){this.value?t.classList.add("hide"):t.classList.remove("hide")}})}(),function({ctxts:t}){const e=t[0].canvas.clientHeight,i=t[0].canvas.clientWidth,a=new s(i/2,e/2);let m={initialFormationRadius:140,particleNumber:1e3,atractorNumber:2,color:new g({h:0,s:0,l:0,a:.1})},v=new f({particleNumber:m.particleNumber,particleOptions:{ctx:t[0],radius:[.25],position:l(m.particleNumber,m.initialFormationRadius).map(t=>t.add(a)),damping:[.998]}}),x=new f({particleNumber:m.atractorNumber,particleOptions:{ctx:t[1],radius:[5],position:Array.from({length:m.atractorNumber},t=>{const r=i<250?i-20:250,l=e<250?e-20:250;return new s(n(a.x-r,a.x+r),n(a.y-l,a.y+l))}),G:5,minDistance:[15],maxDistance:[25],damping:[.9998]}});t[0].fillStyle="#fff",t[0].fillRect(0,0,i,e),t[0].fillStyle=m.color.hsla,t[1].fillStyle="red",x.draw();const b=e=>{y(t[1]),x.draw(),x.update()};x.setDragging(b);const y=(t,s=!1)=>{s?(t.fillStyle="#fff",t.fillRect(0,0,i,e),t.fillStyle=m.color.hsla):t.clearRect(0,0,i,e)},w=t=>{v.draw()},F=t=>{v.update({fn:t=>{x.particles.forEach(e=>{t.applyForce(e.atract(t))})}})},D=function(t,e=0,i=(t=>void 0)){let s,a=!1;const n=function(t){let e=0,i=0;const s=t;return t=>{let a=t-e;if(e=t,(i+=a)>s)return i=0,!0}}(e),r=t=>{a||(a=!0),s=window.requestAnimationFrame(o)},l=t=>{s&&(window.cancelAnimationFrame(s),s=void 0,a=!1)},o=(e=0)=>{i()?l():(n(e)&&t(),r())};return{start:r,stop:l,toggle:t=>{(a=!a)?r():l()},get animating(){return a}}}(t=>{w(),F()},0),L=e=>{y(t[0],!0),v.particleOptions.position=l(v.particleNumber,m.initialFormationRadius).map(t=>t.add(a)),v.setup()};return document.addEventListener("keyup",e=>{"s"==e.key&&D.toggle(),"e"==e.key&&y(t[0],!0),"r"==e.key&&(L(),x.setup()),"t"==e.key&&(y(t[0],!0),v.setup(),x.setup())}),function({eraseFn:t,animationToggleFn:e,saveImgFn:i,atractors:s,particles:a,sketchState:n,updateFns:r}){const l=document.querySelector("#buttons"),m=(new h({parent:l,fn:t,updateFn:null,label:d.erase,title:"erase",id:"erase"}),new c({parent:l,prop:"toggle-animation-btn",value:!0,labelTrue:d.pause,labelFalse:d.play,updateFn:e,title:"play/pause"}),new h({parent:l,fn:i,updateFn:null,label:d.saveImg,title:"download png",id:"saveImg"}),p("Atractors options")),f=new o({parent:m,max:8,min:1,value:s.particleNumber,label:"atractors # ",prop:"particleNumber",scope:s,updateFn:r.atractorNumberSlider}),g=new o({parent:m,max:60,min:1,value:s.particleOptions.G,label:"atracton force strength",prop:"G",scope:s.particleOptions,updateFn:r.atractorsUpdate}),v=new o({parent:m,max:70,min:1,value:s.particleOptions.minDistance,label:"atraction force min. distance",prop:"minDistance",scope:s.particleOptions,updateFn:r.atractorsUpdate}),x=new o({parent:m,max:100,min:10,value:s.particleOptions.maxDistance,label:"atraction force max. distance",prop:"maxDistance",scope:s.particleOptions,updateFn:r.atractorsUpdate}),b=p("Particles options"),y=new o({parent:b,max:3e3,min:100,value:a.particleNumber,label:"particles #",prop:"particleNumber",scope:a,updateFn:r.particleNumberSlider}),w=new o({parent:b,max:2,min:.1,step:.01,value:a.particleOptions.radius,label:"particles radius",prop:"radius",scope:a.particleOptions,updateFn:t=>a.setup()}),F=new o({parent:b,max:.5,min:.01,step:.01,value:.1,label:"particle transparency",prop:"a",scope:n.color,updateFn:r.alphaSlider}),D=new o({parent:b,max:300,min:10,value:n.initialFormationRadius,label:"initial formation radius",prop:"initialFormationRadius",scope:n,updateFn:r.initialRadiusSlider});new h({parent:l,updateFn:null,label:d.randomOptions,title:"randomize values",id:"randomOptions",fn:t=>{u(f),u(g),u(v),u(x),u(y),u(w),u(F),u(D)}})}({atractors:x,particles:v,sketchState:m,updateFns:{atractorNumberSlider:t=>{x.particleOptions.position=Array.from({length:x.particleNumber},t=>new s(n(a.x-350,a.x+350),n(a.y-350,a.y+350))),x.setup(),b()},atractorsUpdate:t=>{x.setup(),b()},particleNumberSlider:t=>{L()},alphaSlider:e=>{t[0].fillStyle=m.color.hsla},initialRadiusSlider:t=>{L()}},eraseFn:e=>y(t[0],!0),animationToggleFn:t=>D.toggle(),saveImgFn:e=>{D.animating&&D.stop(),function(t){const e=r("a",{download:"img.png",href:t.toDataURL("image/png"),style:"display:none"});document.body.appendChild(e),e.click(),e.parentNode.removeChild(e)}(t[0].canvas)}}),{clean:y,draw:w,update:F,animation:D}}({ctxts:[a("#canvas1"),a("#canvas2")]}).animation.start()}]);